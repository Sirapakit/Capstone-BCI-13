import mne
import mne.viz
import numpy as np
import json
from scipy import signal
# from scipy.stats import mode
import os

path = '../json_convert_to_npy/chb04'
patient_chb = 'chb04'
json_filename_array = os.listdir(path)
json_filename_array.sort()

print('--------Start--------')
for index, json_filename in enumerate(json_filename_array):
    print(f'Investigating: {json_filename}')
    if json_filename.endswith('.json'):
        data = open('../' + 'json_convert_to_npy/' + patient_chb + '/' + json_filename)
        f = json.load(data)

        data_file = '../dataset/' + f['patient_ID'] + '/' + f['raw_name']
        raw = mne.io.read_raw(data_file)

        raw_array = raw.get_data()
        # filter_band_1 = [-0.00746130275969432, -0.00775091228015498, -0.00803687583618559, -0.00831761219110410, -0.00859152635432147, -0.00885701632363083, -0.00911247994314634, -0.00935632184750005, -0.00958696046228121, -0.00980283503021094, -0.0100024126321907, -0.0101841951721465, -0.0103467262945138, -0.0104885982032757, -0.0106084583516705, -0.0107050159720369, -0.0107770484157523, -0.0108234072738497, -0.0108430242496626, -0.0108349167557493, -0.0107981932083777, -0.0107320579940071, -0.0106358160834862, -0.0105088772710783, -0.0103507600169348, -0.0101610948732458, -0.00993962747600702, -0.00968622108614084, -0.00940085866558823, -0.00908364447594568, -0.00873480518924006, -0.00835469050251206, -0.00794377325000289, -0.00750264900890155, -0.00703203519679987, -0.00653276966121191, -0.00600580876373075, -0.00545222496361186, -0.00487320390777551, -0.00427004103640315, -0.00364413771545254, -0.00299699690952590, -0.00233021841058220, -0.00164549363998214, -0.000944600043281034, -0.000229395099032949, 0.000498190035369813, 0.00123615721613286, 0.00198244831752100, 0.00273495252064312, 0.00349151385752632, 0.00424993898023541, 0.00500800512371454, 0.00576346823008322, 0.00651407120131354, 0.00725755224655404, 0.00799165328985059, 0.00871412840364894, 0.00942275223324948, 0.0101153283773230, 0.0107896976896881, 0.0114437464677946, 0.0120754144937552, 0.0126827028943150, 0.0132636817868430, 0.0138164976792747, 0.0143393805929141, 0.0148306508781302, 0.0152887256942328, 0.0157121251261990, 0.0160994779124213, 0.0164495267592713, 0.0167611332199954, 0.0170332821172886, 0.0172650854908090, 0.0174557860529000, 0.0176047601378619, 0.0177115201322593, 0.0177757163759463, 0.0177971385257398, 0.0177757163759463, 0.0177115201322593, 0.0176047601378619, 0.0174557860529000, 0.0172650854908090, 0.0170332821172886, 0.0167611332199954, 0.0164495267592713, 0.0160994779124213, 0.0157121251261990, 0.0152887256942328, 0.0148306508781302, 0.0143393805929141, 0.0138164976792747, 0.0132636817868430, 0.0126827028943150, 0.0120754144937552, 0.0114437464677946, 0.0107896976896881, 0.0101153283773230, 0.00942275223324948, 0.00871412840364894, 0.00799165328985059, 0.00725755224655404, 0.00651407120131354, 0.00576346823008322, 0.00500800512371454, 0.00424993898023541, 0.00349151385752632, 0.00273495252064312, 0.00198244831752100, 0.00123615721613286, 0.000498190035369813, -0.000229395099032949, -0.000944600043281034, -0.00164549363998214, -0.00233021841058220, -0.00299699690952590, -0.00364413771545254, -0.00427004103640315, -0.00487320390777551, -0.00545222496361186, -0.00600580876373075, -0.00653276966121191, -0.00703203519679987, -0.00750264900890155, -0.00794377325000289, -0.00835469050251206, -0.00873480518924006, -0.00908364447594568, -0.00940085866558823, -0.00968622108614084, -0.00993962747600702, -0.0101610948732458, -0.0103507600169348, -0.0105088772710783, -0.0106358160834862, -0.0107320579940071, -0.0107981932083777, -0.0108349167557493, -0.0108430242496626, -0.0108234072738497, -0.0107770484157523, -0.0107050159720369, -0.0106084583516705, -0.0104885982032757, -0.0103467262945138, -0.0101841951721465, -0.0100024126321907, -0.00980283503021094, -0.00958696046228121, -0.00935632184750005, -0.00911247994314634, -0.00885701632363083, -0.00859152635432147, -0.00831761219110410, -0.00803687583618559, -0.00775091228015498, -0.00746130275969432]
        # filter_band_2 = [-0.00174052682807970, -0.00183618891780604, -0.00186796015439467, -0.00182873991969156, -0.00171284818676060, -0.00151620728379483, -0.00123649505714197, -0.000873265570839400, -0.000428034053484924, 9.56765469734395e-05, 0.000692329325551443, 0.00135440865877490, 0.00207249727553533, 0.00283539469140513, 0.00363027570668829, 0.00444288684793066, 0.00525777783867776, 0.00605856443394525, 0.00682821825953966, 0.00754937867649397, 0.00820468115570299, 0.00877709621010389, 0.00925027260145455, 0.00960887832396577, 0.00983893277365694, 0.00992812354396643, 0.00986610144612144, 0.00964474763589801, 0.00925840713309038, 0.00870408354028346, 0.00798159039510945, 0.00709365531463185, 0.00604597389941680, 0.00484721124403421, 0.00350894983448103, 0.00204558358440886, 0.000474158753230718, -0.00118583651824341, -0.00291273134369004, -0.00468297624822371, -0.00647148781033014, -0.00825202843815503, -0.00999761520215219, -0.0116809510204907, -0.0132748709826136, -0.0147527962107327, -0.0160891874073939, -0.0172599901256793, -0.0182430638306932, -0.0190185869976145, -0.0195694308110133, -0.0198814944878647, -0.0199439958356788, -0.0197497113678376, -0.0192951611186776, -0.0185807342170509, -0.0176107522731264, -0.0163934686915455, -0.0149410031259459, -0.0132692114156021, -0.0113974924742127, -0.00934853471323162, -0.00714800565729385, -0.00482418942752198, -0.00240757771102952, 6.95793157233808e-05, 0.00257375490177959, 0.00507065264950515, 0.00752573014759231, 0.00990473066297433, 0.0121742140576952, 0.0143020780638859, 0.0162580611730813, 0.0180142186734991, 0.0195453637961163, 0.0208294665001698, 0.0218480031312425, 0.0225862510080680, 0.0230335229230995, 0.0231833375602670, 0.0230335229230995, 0.0225862510080680, 0.0218480031312425, 0.0208294665001698, 0.0195453637961163, 0.0180142186734991, 0.0162580611730813, 0.0143020780638859, 0.0121742140576952, 0.00990473066297433, 0.00752573014759231, 0.00507065264950515, 0.00257375490177959, 6.95793157233808e-05, -0.00240757771102952, -0.00482418942752198, -0.00714800565729385, -0.00934853471323162, -0.0113974924742127, -0.0132692114156021, -0.0149410031259459, -0.0163934686915455, -0.0176107522731264, -0.0185807342170509, -0.0192951611186776, -0.0197497113678376, -0.0199439958356788, -0.0198814944878647, -0.0195694308110133, -0.0190185869976145, -0.0182430638306932, -0.0172599901256793, -0.0160891874073939, -0.0147527962107327, -0.0132748709826136, -0.0116809510204907, -0.00999761520215219, -0.00825202843815503, -0.00647148781033014, -0.00468297624822371, -0.00291273134369004, -0.00118583651824341, 0.000474158753230718, 0.00204558358440886, 0.00350894983448103, 0.00484721124403421, 0.00604597389941680, 0.00709365531463185, 0.00798159039510945, 0.00870408354028346, 0.00925840713309038, 0.00964474763589801, 0.00986610144612144, 0.00992812354396643, 0.00983893277365694, 0.00960887832396577, 0.00925027260145455, 0.00877709621010389, 0.00820468115570299, 0.00754937867649397, 0.00682821825953966, 0.00605856443394525, 0.00525777783867776, 0.00444288684793066, 0.00363027570668829, 0.00283539469140513, 0.00207249727553533, 0.00135440865877490, 0.000692329325551443, 9.56765469734395e-05, -0.000428034053484924, -0.000873265570839400, -0.00123649505714197, -0.00151620728379483, -0.00171284818676060, -0.00182873991969156, -0.00186796015439467, -0.00183618891780604, -0.00174052682807970]
        # filter_band_3 = [-0.000935063880355104, -0.000716467958274841, -0.000367310774766668, 0.000107356912361869, 0.000694114246599031, 0.00137140377823110, 0.00211020685124590, 0.00287514401913025, 0.00362596216505807, 0.00431934975120557, 0.00491100358629276, 0.00535785559269879, 0.00562035706193762, 0.00566471143240761, 0.00546494513137347, 0.00500470969811578, 0.00427871721571191, 0.00329372475462800, 0.00206900157021214, 0.000636234482810177, -0.000961148697070902, -0.00266923170384880, -0.00442540563817067, -0.00616064937821346, -0.00780221172279560, -0.00927659125369148, -0.0105126927959460, -0.0114450271722306, -0.0120168143690486, -0.0121828497014928, -0.0119119982610554, -0.0111891947651609, -0.0100168435293784, -0.00841553602062347, -0.00642403044718667, -0.00409846801653467, -0.00151083259825130, 0.00125330679071151, 0.00409769941981959, 0.00691886134021195, 0.00960994206240403, 0.0120648612991016, 0.0141825522219676, 0.0158711388410219, 0.0170518733874205, 0.0176626651854870, 0.0176610453466990, 0.0170264313021942, 0.0157615810059490, 0.0138931576079612, 0.0114713602987942, 0.00856861445931450, 0.00527735267808548, 0.00170695602354850, -0.00202003941934131, -0.00577233384574431, -0.00941468918703733, -0.0128130045956715, -0.0158394446283015, -0.0183774175027099, -0.0203262037396750, -0.0216050466480413, -0.0221565351069671, -0.0219491352480702, -0.0209787599399541, -0.0192693021595746, -0.0168720989147923, -0.0138643347213228, -0.0103464360094567, -0.00643854850098496, -0.00227622687271384, 0.00199450164276388, 0.00622251203293075, 0.0102571883388552, 0.0139540457998628, 0.0171801498075798, 0.0198191201944185, 0.0217755249377974, 0.0229784908407991, 0.0233843892174715, 0.0229784908407991, 0.0217755249377974, 0.0198191201944185, 0.0171801498075798, 0.0139540457998628, 0.0102571883388552, 0.00622251203293075, 0.00199450164276388, -0.00227622687271384, -0.00643854850098496, -0.0103464360094567, -0.0138643347213228, -0.0168720989147923, -0.0192693021595746, -0.0209787599399541, -0.0219491352480702, -0.0221565351069671, -0.0216050466480413, -0.0203262037396750, -0.0183774175027099, -0.0158394446283015, -0.0128130045956715, -0.00941468918703733, -0.00577233384574431, -0.00202003941934131, 0.00170695602354850, 0.00527735267808548, 0.00856861445931450, 0.0114713602987942, 0.0138931576079612, 0.0157615810059490, 0.0170264313021942, 0.0176610453466990, 0.0176626651854870, 0.0170518733874205, 0.0158711388410219, 0.0141825522219676, 0.0120648612991016, 0.00960994206240403, 0.00691886134021195, 0.00409769941981959, 0.00125330679071151, -0.00151083259825130, -0.00409846801653467, -0.00642403044718667, -0.00841553602062347, -0.0100168435293784, -0.0111891947651609, -0.0119119982610554, -0.0121828497014928, -0.0120168143690486, -0.0114450271722306, -0.0105126927959460, -0.00927659125369148, -0.00780221172279560, -0.00616064937821346, -0.00442540563817067, -0.00266923170384880, -0.000961148697070902, 0.000636234482810177, 0.00206900157021214, 0.00329372475462800, 0.00427871721571191, 0.00500470969811578, 0.00546494513137347, 0.00566471143240761, 0.00562035706193762, 0.00535785559269879, 0.00491100358629276, 0.00431934975120557, 0.00362596216505807, 0.00287514401913025, 0.00211020685124590, 0.00137140377823110, 0.000694114246599031, 0.000107356912361869, -0.000367310774766668, -0.000716467958274841, -0.000935063880355104]
        # filter_band_4 = [-0.000115262676354512, 0.000414330876085213, 0.00107029561950722, 0.00179727218287726, 0.00252452307216603, 0.00317191062723746, 0.00365721726101749, 0.00390419235232974, 0.00385061463827836, 0.00345562312737219, 0.00270559872949103, 0.00161797280623633, 0.000242491906654552, -0.00134033099296464, -0.00302361493940997, -0.00468114828389334, -0.00617661398991259, -0.00737434011093271, -0.00815074756647958, -0.00840556520762389, -0.00807185400370896, -0.00712393328680929, -0.00558243120447373, -0.00351588115534616, -0.00103854220607017, 0.00169558465726092, 0.00450226382660877, 0.00717947635406298, 0.00952197128055182, 0.0113368660453038, 0.0124591141952280, 0.0127656173249562, 0.0121868129328093, 0.0107147196695126, 0.00840665762081433, 0.00538416795793750, 0.00182701155514502, -0.00203749646938852, -0.00594918890225197, -0.00963282369449316, -0.0128177040933502, -0.0152577253338188, -0.0167503509848913, -0.0171530541780348, -0.0163959044888077, -0.0144892320632713, -0.0115256401592229, -0.00767604180166702, -0.00317983633339256, 0.00167021554969268, 0.00654744792607948, 0.0111137579932830, 0.0150435102145133, 0.0180471550529134, 0.0198928223045741, 0.0204242602796739, 0.0195737274797716, 0.0173687875691551, 0.0139323873964806, 0.00947608081092836, 0.00428676266803078, -0.00129223958827422, -0.00688444150983242, -0.0121062291986226, -0.0165937982506089, -0.0200290710114888, -0.0221627080162171, -0.0228325179081131, -0.0219758855689684, -0.0196352585255532, -0.0159562267490835, -0.0111782646931419, -0.00561873759681809, 0.000348732764821034, 0.00632003133075172, 0.0118886221248580, 0.0166739329572456, 0.0203480238672081, 0.0226586269800029, 0.0234469017077285, 0.0226586269800029, 0.0203480238672081, 0.0166739329572456, 0.0118886221248580, 0.00632003133075172, 0.000348732764821034, -0.00561873759681809, -0.0111782646931419, -0.0159562267490835, -0.0196352585255532, -0.0219758855689684, -0.0228325179081131, -0.0221627080162171, -0.0200290710114888, -0.0165937982506089, -0.0121062291986226, -0.00688444150983242, -0.00129223958827422, 0.00428676266803078, 0.00947608081092836, 0.0139323873964806, 0.0173687875691551, 0.0195737274797716, 0.0204242602796739, 0.0198928223045741, 0.0180471550529134, 0.0150435102145133, 0.0111137579932830, 0.00654744792607948, 0.00167021554969268, -0.00317983633339256, -0.00767604180166702, -0.0115256401592229, -0.0144892320632713, -0.0163959044888077, -0.0171530541780348, -0.0167503509848913, -0.0152577253338188, -0.0128177040933502, -0.00963282369449316, -0.00594918890225197, -0.00203749646938852, 0.00182701155514502, 0.00538416795793750, 0.00840665762081433, 0.0107147196695126, 0.0121868129328093, 0.0127656173249562, 0.0124591141952280, 0.0113368660453038, 0.00952197128055182, 0.00717947635406298, 0.00450226382660877, 0.00169558465726092, -0.00103854220607017, -0.00351588115534616, -0.00558243120447373, -0.00712393328680929, -0.00807185400370896, -0.00840556520762389, -0.00815074756647958, -0.00737434011093271, -0.00617661398991259, -0.00468114828389334, -0.00302361493940997, -0.00134033099296464, 0.000242491906654552, 0.00161797280623633, 0.00270559872949103, 0.00345562312737219, 0.00385061463827836, 0.00390419235232974, 0.00365721726101749, 0.00317191062723746, 0.00252452307216603, 0.00179727218287726, 0.00107029561950722, 0.000414330876085213, -0.000115262676354512]
        # filter_band_5 = [0.000682399660233684, 0.00138656908759435, 0.00208789570459458, 0.00265696461458574, 0.00296563041658014, 0.00290821399663400, 0.00242115016640657, 0.00149800830990320, 0.000197293350403221, -0.00135868321165896, -0.00299439803592753, -0.00450039618262016, -0.00565919504739980, -0.00627468249207828, -0.00620118377307079, -0.00536816209226318, -0.00379684743795580, -0.00160594082323894, 0.000995172085252156, 0.00372569303863716, 0.00626350432254239, 0.00828288561283195, 0.00949546063794010, 0.00968929323731183, 0.00876099109919219, 0.00673627780248919, 0.00377571360125400, 0.000163954464601474, -0.00371705967606194, -0.00742854557818289, -0.0105246632667242, -0.0126059776145371, -0.0133701846121521, -0.0126537221594912, -0.0104587132814382, -0.00696124456731494, -0.00249909924583446, 0.00246049896115471, 0.00737010853071887, 0.0116630446615584, 0.0148192540547233, 0.0164283780412832, 0.0162423409269026, 0.0142107830240861, 0.0104944847916217, 0.00545440389049334, -0.000383210404898814, -0.00638228537715145, -0.0118670745979614, -0.0161991607219319, -0.0188524390514430, -0.0194771988416061, -0.0179454695091347, -0.0143718102397071, -0.00910647574082454, -0.00270107535011527, 0.00414991390601874, 0.0106855035176741, 0.0161639077477362, 0.0199478317023608, 0.0215794070144622, 0.0208358753874112, 0.0177592134832815, 0.0126558220797884, 0.00606583424091618, -0.00129486707721528, -0.00861360842426269, -0.0150720227791720, -0.0199389224503000, -0.0226542592445895, -0.0228944024345445, -0.0206110350570209, -0.0160389571478205, -0.00967164739347422, -0.00220715851319816, 0.00552962929888155, 0.0126796044112207, 0.0184463175834362, 0.0221860822319712, 0.0234809375152661, 0.0221860822319712, 0.0184463175834362, 0.0126796044112207, 0.00552962929888155, -0.00220715851319816, -0.00967164739347422, -0.0160389571478205, -0.0206110350570209, -0.0228944024345445, -0.0226542592445895, -0.0199389224503000, -0.0150720227791720, -0.00861360842426269, -0.00129486707721528, 0.00606583424091618, 0.0126558220797884, 0.0177592134832815, 0.0208358753874112, 0.0215794070144622, 0.0199478317023608, 0.0161639077477362, 0.0106855035176741, 0.00414991390601874, -0.00270107535011527, -0.00910647574082454, -0.0143718102397071, -0.0179454695091347, -0.0194771988416061, -0.0188524390514430, -0.0161991607219319, -0.0118670745979614, -0.00638228537715145, -0.000383210404898814, 0.00545440389049334, 0.0104944847916217, 0.0142107830240861, 0.0162423409269026, 0.0164283780412832, 0.0148192540547233, 0.0116630446615584, 0.00737010853071887, 0.00246049896115471, -0.00249909924583446, -0.00696124456731494, -0.0104587132814382, -0.0126537221594912, -0.0133701846121521, -0.0126059776145371, -0.0105246632667242, -0.00742854557818289, -0.00371705967606194, 0.000163954464601474, 0.00377571360125400, 0.00673627780248919, 0.00876099109919219, 0.00968929323731183, 0.00949546063794010, 0.00828288561283195, 0.00626350432254239, 0.00372569303863716, 0.000995172085252156, -0.00160594082323894, -0.00379684743795580, -0.00536816209226318, -0.00620118377307079, -0.00627468249207828, -0.00565919504739980, -0.00450039618262016, -0.00299439803592753, -0.00135868321165896, 0.000197293350403221, 0.00149800830990320, 0.00242115016640657, 0.00290821399663400, 0.00296563041658014, 0.00265696461458574, 0.00208789570459458, 0.00138656908759435, 0.000682399660233684]
        # filter_band_6 = [0.00132880175369376, 0.00197324918065014, 0.00237008427336357, 0.00235292793334883, 0.00182359683244801, 0.000785198089478375, -0.000643819958049911, -0.00223952308845124, -0.00370640197940848, -0.00473042445109492, -0.00504191950290612, -0.00447619242283914, -0.00301924834807534, -0.000827995370668348, 0.00178143356477442, 0.00437776372513758, 0.00648523921709865, 0.00766938349988061, 0.00762257934713234, 0.00623308485081286, 0.00362307704852510, 0.000146174995460478, -0.00365811585888389, -0.00714767849277411, -0.00968601623470309, -0.0107572138881706, -0.0100670029385113, -0.00761059233170722, -0.00369285591628089, 0.00110567962126833, 0.00601412275664081, 0.0101954089570125, 0.0128893369171106, 0.0135499500738959, 0.0119525316920171, 0.00824969137878354, 0.00296411063203890, -0.00308380354282560, -0.00890364420213361, -0.0134981729440442, -0.0160348896159029, -0.0159963638611894, -0.0132822330150702, -0.00824319463045547, -0.00163848493384041, 0.00547860765027439, 0.0119299336250842, 0.0166090051287531, 0.0186718244625875, 0.0176889300429223, 0.0137312759991155, 0.00737320044054926, -0.000390412642878154, -0.00830094374938396, -0.0150419233067909, -0.0194600138248364, -0.0207636855918955, -0.0186651391953733, -0.0134399938109430, -0.00589280866656675, 0.00276761593911118, 0.0111237026500028, 0.0177834172430625, 0.0216143408799702, 0.0219377813303763, 0.0186493963512144, 0.0122448208267298, 0.00374465544305351, -0.00546978638567280, -0.0138832754054602, -0.0200983905061679, -0.0230699350837493, -0.0222823468159586, -0.0178397216938012, -0.0104526381334016, -0.00132332565798365, 0.00805207262185972, 0.0161312823870934, 0.0215822679989937, 0.0235051412750471, 0.0215822679989937, 0.0161312823870934, 0.00805207262185972, -0.00132332565798365, -0.0104526381334016, -0.0178397216938012, -0.0222823468159586, -0.0230699350837493, -0.0200983905061679, -0.0138832754054602, -0.00546978638567280, 0.00374465544305351, 0.0122448208267298, 0.0186493963512144, 0.0219377813303763, 0.0216143408799702, 0.0177834172430625, 0.0111237026500028, 0.00276761593911118, -0.00589280866656675, -0.0134399938109430, -0.0186651391953733, -0.0207636855918955, -0.0194600138248364, -0.0150419233067909, -0.00830094374938396, -0.000390412642878154, 0.00737320044054926, 0.0137312759991155, 0.0176889300429223, 0.0186718244625875, 0.0166090051287531, 0.0119299336250842, 0.00547860765027439, -0.00163848493384041, -0.00824319463045547, -0.0132822330150702, -0.0159963638611894, -0.0160348896159029, -0.0134981729440442, -0.00890364420213361, -0.00308380354282560, 0.00296411063203890, 0.00824969137878354, 0.0119525316920171, 0.0135499500738959, 0.0128893369171106, 0.0101954089570125, 0.00601412275664081, 0.00110567962126833, -0.00369285591628089, -0.00761059233170722, -0.0100670029385113, -0.0107572138881706, -0.00968601623470309, -0.00714767849277411, -0.00365811585888389, 0.000146174995460478, 0.00362307704852510, 0.00623308485081286, 0.00762257934713234, 0.00766938349988061, 0.00648523921709865, 0.00437776372513758, 0.00178143356477442, -0.000827995370668348, -0.00301924834807534, -0.00447619242283914, -0.00504191950290612, -0.00473042445109492, -0.00370640197940848, -0.00223952308845124, -0.000643819958049911, 0.000785198089478375, 0.00182359683244801, 0.00235292793334883, 0.00237008427336357, 0.00197324918065014, 0.00132880175369376]
        # filter_band_7 = [0.00170803490229575, 0.00203159257727944, 0.00183373160602912, 0.00102965017130619, -0.000288332424937886, -0.00184950385530197, -0.00325778546872152, -0.00408939719098231, -0.00401159860863592, -0.00289062631205755, -0.000856952493878816, 0.00169507424654060, 0.00418009089950548, 0.00595468008709178, 0.00648051960851538, 0.00547696876991433, 0.00302156150418032, -0.000432892716684140, -0.00413658388639172, -0.00720438904958414, -0.00882638967193634, -0.00847733702409265, -0.00607166940505447, -0.00202064166820212, 0.00283013130240197, 0.00737570469168288, 0.0105035952397161, 0.0113649328023677, 0.00959907272085606, 0.00545325681841027, -0.000238596071500596, -0.00622119039210128, -0.0110951640221533, -0.0136450583914171, -0.0131409183143205, -0.00953894350134712, -0.00352746409452231, 0.00360050532493433, 0.0102257019912696, 0.0147720397931800, 0.0160823834253325, 0.0137108678058944, 0.00805830828117956, 0.000311985419064216, -0.00780350209536374, -0.0144121306229670, -0.0179223102466770, -0.0174109462538179, -0.0128628317989708, -0.00520389846831090, 0.00388607589662410, 0.0123437651311030, 0.0181935487029687, 0.0200114330087317, 0.0172721444223132, 0.0104946618605282, 0.00114693982683470, -0.00867355032638994, -0.0167136063662731, -0.0210846753485359, -0.0207088746402777, -0.0155847679268937, -0.00680734006952815, 0.00366687435377616, 0.0134589406284540, 0.0203116977711379, 0.0226136050256544, 0.0197798838999544, 0.0124003229886479, 0.00211651994531225, -0.00874590504849879, -0.0177071332601826, -0.0227034219207163, -0.0225657482830972, -0.0172950508045330, -0.00806887599538339, 0.00302365144827168, 0.0134584431084348, 0.0208551044585293, 0.0235240031480327, 0.0208551044585293, 0.0134584431084348, 0.00302365144827168, -0.00806887599538339, -0.0172950508045330, -0.0225657482830972, -0.0227034219207163, -0.0177071332601826, -0.00874590504849879, 0.00211651994531225, 0.0124003229886479, 0.0197798838999544, 0.0226136050256544, 0.0203116977711379, 0.0134589406284540, 0.00366687435377616, -0.00680734006952815, -0.0155847679268937, -0.0207088746402777, -0.0210846753485359, -0.0167136063662731, -0.00867355032638994, 0.00114693982683470, 0.0104946618605282, 0.0172721444223132, 0.0200114330087317, 0.0181935487029687, 0.0123437651311030, 0.00388607589662410, -0.00520389846831090, -0.0128628317989708, -0.0174109462538179, -0.0179223102466770, -0.0144121306229670, -0.00780350209536374, 0.000311985419064216, 0.00805830828117956, 0.0137108678058944, 0.0160823834253325, 0.0147720397931800, 0.0102257019912696, 0.00360050532493433, -0.00352746409452231, -0.00953894350134712, -0.0131409183143205, -0.0136450583914171, -0.0110951640221533, -0.00622119039210128, -0.000238596071500596, 0.00545325681841027, 0.00959907272085606, 0.0113649328023677, 0.0105035952397161, 0.00737570469168288, 0.00283013130240197, -0.00202064166820212, -0.00607166940505447, -0.00847733702409265, -0.00882638967193634, -0.00720438904958414, -0.00413658388639172, -0.000432892716684140, 0.00302156150418032, 0.00547696876991433, 0.00648051960851538, 0.00595468008709178, 0.00418009089950548, 0.00169507424654060, -0.000856952493878816, -0.00289062631205755, -0.00401159860863592, -0.00408939719098231, -0.00325778546872152, -0.00184950385530197, -0.000288332424937886, 0.00102965017130619, 0.00183373160602912, 0.00203159257727944, 0.00170803490229575]
        # filter_band_8 = [0.00175136343908006, 0.00155226033518152, 0.000668404486553345, -0.000739434336048251, -0.00225692419357041, -0.00333501881701138, -0.00348046547651369, -0.00245372537465612, -0.000400130098721296, 0.00214315914117983, 0.00438229135072609, 0.00551198770287292, 0.00499584270882180, 0.00278626601856835, -0.000599702577623739, -0.00419030799050297, -0.00683585790166384, -0.00757425419863861, -0.00596971704165011, -0.00230805675605025, 0.00242969581525211, 0.00682557047779254, 0.00944850686901667, 0.00931724524536599, 0.00625326617184259, 0.00100009742764349, -0.00494682171755107, -0.00976476682196353, -0.0118626822588745, -0.0104029423302331, -0.00561571468570452, 0.00120765945020331, 0.00805921709120811, 0.0128062899294471, 0.0138560127481125, 0.0106851291985834, 0.00406002869281167, -0.00413826002240539, -0.0114480822411657, -0.0155686565203796, -0.0150850006129407, -0.00994760237991845, -0.00154576596648321, 0.00766512034581670, 0.0148834694103295, 0.0178167972956611, 0.0154103693209691, 0.00821737074625264, -0.00171712736267325, -0.0114385108867155, -0.0179652214100213, -0.0192068063815739, -0.0146336583282255, -0.00548375924038437, 0.00557030872851583, 0.0152052938496057, 0.0204512205724119, 0.0196106073024864, 0.0128073344877175, 0.00198774901977106, -0.00963785496713856, -0.0185526193689546, -0.0220024029967929, -0.0188502368968888, -0.00994978846884724, 0.00208453927564939, 0.0136494261403938, 0.0212373577196148, 0.0225059732098837, 0.0170043627367659, 0.00633014693217177, -0.00633660407684108, -0.0171859990420399, -0.0229305664729076, -0.0218067451863520, -0.0141189323306791, -0.00215746485840819, 0.0104875222015027, 0.0200096643361083, 0.0235385213276456, 0.0200096643361083, 0.0104875222015027, -0.00215746485840819, -0.0141189323306791, -0.0218067451863520, -0.0229305664729076, -0.0171859990420399, -0.00633660407684108, 0.00633014693217177, 0.0170043627367659, 0.0225059732098837, 0.0212373577196148, 0.0136494261403938, 0.00208453927564939, -0.00994978846884724, -0.0188502368968888, -0.0220024029967929, -0.0185526193689546, -0.00963785496713856, 0.00198774901977106, 0.0128073344877175, 0.0196106073024864, 0.0204512205724119, 0.0152052938496057, 0.00557030872851583, -0.00548375924038437, -0.0146336583282255, -0.0192068063815739, -0.0179652214100213, -0.0114385108867155, -0.00171712736267325, 0.00821737074625264, 0.0154103693209691, 0.0178167972956611, 0.0148834694103295, 0.00766512034581670, -0.00154576596648321, -0.00994760237991845, -0.0150850006129407, -0.0155686565203796, -0.0114480822411657, -0.00413826002240539, 0.00406002869281167, 0.0106851291985834, 0.0138560127481125, 0.0128062899294471, 0.00805921709120811, 0.00120765945020331, -0.00561571468570452, -0.0104029423302331, -0.0118626822588745, -0.00976476682196353, -0.00494682171755107, 0.00100009742764349, 0.00625326617184259, 0.00931724524536599, 0.00944850686901667, 0.00682557047779254, 0.00242969581525211, -0.00230805675605025, -0.00596971704165011, -0.00757425419863861, -0.00683585790166384, -0.00419030799050297, -0.000599702577623739, 0.00278626601856835, 0.00499584270882180, 0.00551198770287292, 0.00438229135072609, 0.00214315914117983, -0.000400130098721296, -0.00245372537465612, -0.00348046547651369, -0.00333501881701138, -0.00225692419357041, -0.000739434336048251, 0.000668404486553345, 0.00155226033518152, 0.00175136343908006]

        filter_band_1 = [-0.00107993806311353, -0.00106217163565181, -0.00104510238307734, -0.00102882032057693, -0.00101357133327608, -0.000999782376564196, -0.000988081923526628, -0.000979314791103734, -0.000974550588472947, -0.000975085164257233, -0.000982434580981359, -0.000998321312744441, -0.00102465254197012, -0.00106349061961468, -0.00111701594637719, -0.00118748272610121, -0.00127716823242759, -0.00138831641158684, -0.00152307681382854, -0.00168343999936680, -0.00187117069813066, -0.00208774011264687, -0.00233425883707135, -0.00261141192023950, -0.00291939762469068, -0.00325787142560709, -0.00362589675279992, -0.00402190390525106, -0.00444365846192655, -0.00488824037594689, -0.00535203477371457, -0.00583073528887907, -0.00631936054626844, -0.00681228417687241, -0.00730327849582716, -0.00778557171571805, -0.00825191830227724, -0.00869468181380980, -0.00910592930464674, -0.00947753612181550, -0.00980129968806068, -0.0100690606482630, -0.0102728295648152, -0.0104049171848486, -0.0104580661720998, -0.0104255821018470, -0.0103014614612624, -0.0100805143815706, -0.00975847985367612, -0.00933213124576528, -0.00879937004933520, -0.00815930592792519, -0.00741232132849578, -0.00656011913616001, -0.00560575210535546, -0.00455363308044548, -0.00340952532147838, -0.00218051257124607, -0.000874948832308795, 0.000497611838562294, 0.00192650487206738, 0.00340006308460933, 0.00490574163233417, 0.00643025841693759, 0.00795974805938918, 0.00947992730667490, 0.0109762695191370, 0.0124341857062006, 0.0138392094397595, 0.0151771828800697, 0.0164344411006942, 0.0175979918980667, 0.0186556883179377, 0.0195963912248275, 0.0204101193802545, 0.0210881846787323, 0.0216233104143159, 0.0220097307110830, 0.0222432695439173, 0.0223213980962941, 0.0222432695439173, 0.0220097307110830, 0.0216233104143159, 0.0210881846787323, 0.0204101193802545, 0.0195963912248275, 0.0186556883179377, 0.0175979918980667, 0.0164344411006942, 0.0151771828800697, 0.0138392094397595, 0.0124341857062006, 0.0109762695191370, 0.00947992730667490, 0.00795974805938918, 0.00643025841693759, 0.00490574163233417, 0.00340006308460933, 0.00192650487206738, 0.000497611838562294, -0.000874948832308795, -0.00218051257124607, -0.00340952532147838, -0.00455363308044548, -0.00560575210535546, -0.00656011913616001, -0.00741232132849578, -0.00815930592792519, -0.00879937004933520, -0.00933213124576528, -0.00975847985367612, -0.0100805143815706, -0.0103014614612624, -0.0104255821018470, -0.0104580661720998, -0.0104049171848486, -0.0102728295648152, -0.0100690606482630, -0.00980129968806068, -0.00947753612181550, -0.00910592930464674, -0.00869468181380980, -0.00825191830227724, -0.00778557171571805, -0.00730327849582716, -0.00681228417687241, -0.00631936054626844, -0.00583073528887907, -0.00535203477371457, -0.00488824037594689, -0.00444365846192655, -0.00402190390525106, -0.00362589675279992, -0.00325787142560709, -0.00291939762469068, -0.00261141192023950, -0.00233425883707135, -0.00208774011264687, -0.00187117069813066, -0.00168343999936680, -0.00152307681382854, -0.00138831641158684, -0.00127716823242759, -0.00118748272610121, -0.00111701594637719, -0.00106349061961468, -0.00102465254197012, -0.000998321312744441, -0.000982434580981359, -0.000975085164257233, -0.000974550588472947, -0.000979314791103734, -0.000988081923526628, -0.000999782376564196, -0.00101357133327608, -0.00102882032057693, -0.00104510238307734, -0.00106217163565181, -0.00107993806311353]
        filter_band_2 = [-0.00107993806311353, -0.00106217163565181, -0.00104510238307734, -0.00102882032057693, -0.00101357133327608, -0.000999782376564196, -0.000988081923526628, -0.000979314791103734, -0.000974550588472947, -0.000975085164257233, -0.000982434580981359, -0.000998321312744441, -0.00102465254197012, -0.00106349061961468, -0.00111701594637719, -0.00118748272610121, -0.00127716823242759, -0.00138831641158684, -0.00152307681382854, -0.00168343999936680, -0.00187117069813066, -0.00208774011264687, -0.00233425883707135, -0.00261141192023950, -0.00291939762469068, -0.00325787142560709, -0.00362589675279992, -0.00402190390525106, -0.00444365846192655, -0.00488824037594689, -0.00535203477371457, -0.00583073528887907, -0.00631936054626844, -0.00681228417687241, -0.00730327849582716, -0.00778557171571805, -0.00825191830227724, -0.00869468181380980, -0.00910592930464674, -0.00947753612181550, -0.00980129968806068, -0.0100690606482630, -0.0102728295648152, -0.0104049171848486, -0.0104580661720998, -0.0104255821018470, -0.0103014614612624, -0.0100805143815706, -0.00975847985367612, -0.00933213124576528, -0.00879937004933520, -0.00815930592792519, -0.00741232132849578, -0.00656011913616001, -0.00560575210535546, -0.00455363308044548, -0.00340952532147838, -0.00218051257124607, -0.000874948832308795, 0.000497611838562294, 0.00192650487206738, 0.00340006308460933, 0.00490574163233417, 0.00643025841693759, 0.00795974805938918, 0.00947992730667490, 0.0109762695191370, 0.0124341857062006, 0.0138392094397595, 0.0151771828800697, 0.0164344411006942, 0.0175979918980667, 0.0186556883179377, 0.0195963912248275, 0.0204101193802545, 0.0210881846787323, 0.0216233104143159, 0.0220097307110830, 0.0222432695439173, 0.0223213980962941, 0.0222432695439173, 0.0220097307110830, 0.0216233104143159, 0.0210881846787323, 0.0204101193802545, 0.0195963912248275, 0.0186556883179377, 0.0175979918980667, 0.0164344411006942, 0.0151771828800697, 0.0138392094397595, 0.0124341857062006, 0.0109762695191370, 0.00947992730667490, 0.00795974805938918, 0.00643025841693759, 0.00490574163233417, 0.00340006308460933, 0.00192650487206738, 0.000497611838562294, -0.000874948832308795, -0.00218051257124607, -0.00340952532147838, -0.00455363308044548, -0.00560575210535546, -0.00656011913616001, -0.00741232132849578, -0.00815930592792519, -0.00879937004933520, -0.00933213124576528, -0.00975847985367612, -0.0100805143815706, -0.0103014614612624, -0.0104255821018470, -0.0104580661720998, -0.0104049171848486, -0.0102728295648152, -0.0100690606482630, -0.00980129968806068, -0.00947753612181550, -0.00910592930464674, -0.00869468181380980, -0.00825191830227724, -0.00778557171571805, -0.00730327849582716, -0.00681228417687241, -0.00631936054626844, -0.00583073528887907, -0.00535203477371457, -0.00488824037594689, -0.00444365846192655, -0.00402190390525106, -0.00362589675279992, -0.00325787142560709, -0.00291939762469068, -0.00261141192023950, -0.00233425883707135, -0.00208774011264687, -0.00187117069813066, -0.00168343999936680, -0.00152307681382854, -0.00138831641158684, -0.00127716823242759, -0.00118748272610121, -0.00111701594637719, -0.00106349061961468, -0.00102465254197012, -0.000998321312744441, -0.000982434580981359, -0.000975085164257233, -0.000974550588472947, -0.000979314791103734, -0.000988081923526628, -0.000999782376564196, -0.00101357133327608, -0.00102882032057693, -0.00104510238307734, -0.00106217163565181, -0.00107993806311353]
        filter_band_3 = [4.05568493008054e-05, 9.91986524849151e-06, -3.27975086399816e-05, -8.71016238998287e-05, -0.000151741668989157, -0.000224489182257267, -0.000301913530300002, -0.000379201424793642, -0.000450073733756132, -0.000506851157361419, -0.000540711226656778, -0.000542162798717908, -0.000501741854739701, -0.000410905830235914, -0.000263075432219409, -5.47458685338766e-05, 0.000213433270226274, 0.000535725619110375, 0.000900644858523925, 0.00129067647326527, 0.00168248182066925, 0.00204765148890000, 0.00235403403202537, 0.00256761743757390, 0.00265488777315244, 0.00258553676214860, 0.00233534233655093, 0.00188900828070861, 0.00124272525120117, 0.000406209220132064, -0.000596012995581380, -0.00172426723714936, -0.00292448677191714, -0.00413012967795762, -0.00526524662184444, -0.00624859622756019, -0.00699861435378107, -0.00743895964455144, -0.00750428789865896, -0.00714585870746563, -0.00633655484898834, -0.00507490181869828, -0.00338771325912798, -0.00133105721554970, 0.00101066503160708, 0.00352761676354430, 0.00608935564848193, 0.00855141143390244, 0.0107632919785987, 0.0125774771087851, 0.0138588628202628, 0.0144940537772940, 0.0143998762693351, 0.0135305006296050, 0.0118826225076365, 0.00949825410605768, 0.00646481423313198, 0.00291237165883950, -0.000991920666205665, -0.00505197457435432, -0.00905309209194124, -0.0127739002519791, -0.0159992002606525, -0.0185329502142794, -0.0202105643226907, -0.0209097288723878, -0.0205590063253225, -0.0191436206109062, -0.0167079818441980, -0.0133547072228570, -0.00924011402047021, -0.00456638602385302, 0.000429168621809851, 0.00548715712157735, 0.0103406720601879, 0.0147305161998462, 0.0184201539030476, 0.0212094683046178, 0.0229464705649707, 0.0235362306803060, 0.0229464705649707, 0.0212094683046178, 0.0184201539030476, 0.0147305161998462, 0.0103406720601879, 0.00548715712157735, 0.000429168621809851, -0.00456638602385302, -0.00924011402047021, -0.0133547072228570, -0.0167079818441980, -0.0191436206109062, -0.0205590063253225, -0.0209097288723878, -0.0202105643226907, -0.0185329502142794, -0.0159992002606525, -0.0127739002519791, -0.00905309209194124, -0.00505197457435432, -0.000991920666205665, 0.00291237165883950, 0.00646481423313198, 0.00949825410605768, 0.0118826225076365, 0.0135305006296050, 0.0143998762693351, 0.0144940537772940, 0.0138588628202628, 0.0125774771087851, 0.0107632919785987, 0.00855141143390244, 0.00608935564848193, 0.00352761676354430, 0.00101066503160708, -0.00133105721554970, -0.00338771325912798, -0.00507490181869828, -0.00633655484898834, -0.00714585870746563, -0.00750428789865896, -0.00743895964455144, -0.00699861435378107, -0.00624859622756019, -0.00526524662184444, -0.00413012967795762, -0.00292448677191714, -0.00172426723714936, -0.000596012995581380, 0.000406209220132064, 0.00124272525120117, 0.00188900828070861, 0.00233534233655093, 0.00258553676214860, 0.00265488777315244, 0.00256761743757390, 0.00235403403202537, 0.00204765148890000, 0.00168248182066925, 0.00129067647326527, 0.000900644858523925, 0.000535725619110375, 0.000213433270226274, -5.47458685338766e-05, -0.000263075432219409, -0.000410905830235914, -0.000501741854739701, -0.000542162798717908, -0.000540711226656778, -0.000506851157361419, -0.000450073733756132, -0.000379201424793642, -0.000301913530300002, -0.000224489182257267, -0.000151741668989157, -8.71016238998287e-05, -3.27975086399816e-05, 9.91986524849151e-06, 4.05568493008054e-05]
        filter_band_4 = [-2.37755465563127e-05, -7.54488501182026e-05, -0.000135185097965791, -0.000197126149209651, -0.000253782016444110, -0.000296286963540858, -0.000314923213857793, -0.000299982284046228, -0.000242979151143352, -0.000138157166280288, 1.58659742249548e-05, 0.000214542651262042, 0.000446219889609860, 0.000691652560156669, 0.000924481350377313, 0.00111286377973549, 0.00122230759916255, 0.00121957954199551, 0.00107737044646575, 0.000779217889097063, 0.000324049487221106, -0.000270358346199424, -0.000965689060838149, -0.00170372124543236, -0.00240962752828757, -0.00299797065631739, -0.00338107660121645, -0.00347910245385377, -0.00323079449792006, -0.00260369755704932, -0.00160247252035717, -0.000274034247236334, 0.00129155165471530, 0.00296508703465547, 0.00458733079453202, 0.00598272046271484, 0.00697667859854179, 0.00741491155904696, 0.00718269865888140, 0.00622195922379128, 0.00454391759190356, 0.00223547980767094, -0.000542021708534469, -0.00356231128067265, -0.00655159486739934, -0.00921271813784052, -0.0112539905877847, -0.0124199187102494, -0.0125206622281902, -0.0114569269737111, -0.00923727000300756, -0.00598541088701646, -0.00193607019803594, 0.00258099389695042, 0.00716782362824101, 0.0113938187888937, 0.0148367965221444, 0.0171255697855808, 0.0179796867114379, 0.0172420530405899, 0.0149007056614412, 0.0110969776463657, 0.00611860559634064, 0.000377849191640076, -0.00562373664152806, -0.0113407830238971, -0.0162355725646101, -0.0198304580313102, -0.0217559498425204, -0.0217894840688195, -0.0198807109428206, -0.0161604287726853, -0.0109319027790520, -0.00464508759955234, 0.00214396994780568, 0.00882472155742775, 0.0147897009010188, 0.0194924290519816, 0.0224998814893366, 0.0235342620603006, 0.0224998814893366, 0.0194924290519816, 0.0147897009010188, 0.00882472155742775, 0.00214396994780568, -0.00464508759955234, -0.0109319027790520, -0.0161604287726853, -0.0198807109428206, -0.0217894840688195, -0.0217559498425204, -0.0198304580313102, -0.0162355725646101, -0.0113407830238971, -0.00562373664152806, 0.000377849191640076, 0.00611860559634064, 0.0110969776463657, 0.0149007056614412, 0.0172420530405899, 0.0179796867114379, 0.0171255697855808, 0.0148367965221444, 0.0113938187888937, 0.00716782362824101, 0.00258099389695042, -0.00193607019803594, -0.00598541088701646, -0.00923727000300756, -0.0114569269737111, -0.0125206622281902, -0.0124199187102494, -0.0112539905877847, -0.00921271813784052, -0.00655159486739934, -0.00356231128067265, -0.000542021708534469, 0.00223547980767094, 0.00454391759190356, 0.00622195922379128, 0.00718269865888140, 0.00741491155904696, 0.00697667859854179, 0.00598272046271484, 0.00458733079453202, 0.00296508703465547, 0.00129155165471530, -0.000274034247236334, -0.00160247252035717, -0.00260369755704932, -0.00323079449792006, -0.00347910245385377, -0.00338107660121645, -0.00299797065631739, -0.00240962752828757, -0.00170372124543236, -0.000965689060838149, -0.000270358346199424, 0.000324049487221106, 0.000779217889097063, 0.00107737044646575, 0.00121957954199551, 0.00122230759916255, 0.00111286377973549, 0.000924481350377313, 0.000691652560156669, 0.000446219889609860, 0.000214542651262042, 1.58659742249548e-05, -0.000138157166280288, -0.000242979151143352, -0.000299982284046228, -0.000314923213857793, -0.000296286963540858, -0.000253782016444110, -0.000197126149209651, -0.000135185097965791, -7.54488501182026e-05, -2.37755465563127e-05]
        filter_band_5 = [-8.25409658428109e-05, -0.000139765758160562, -0.000189984479364148, -0.000220977960242162, -0.000220793193805340, -0.000179687654761451, -9.23670535970729e-05, 3.97530713518094e-05, 0.000206703148531369, 0.000389091642483222, 0.000558776442653258, 0.000681488108663034, 0.000721504882577139, 0.000648039691338143, 0.000442509436653692, 0.000105423927229312, -0.000338627172940407, -0.000839395554312734, -0.00132396245541680, -0.00170477966840913, -0.00189232994728499, -0.00181095513780384, -0.00141547710442119, -0.000705615253438141, 0.000264936464691418, 0.00138746198484246, 0.00250684960173142, 0.00344000711841334, 0.00400238630718909, 0.00403918325420695, 0.00345640445847324, 0.00224629919034312, 0.000501876446252219, -0.00158357268836834, -0.00373393519175673, -0.00562399723501012, -0.00692579126630320, -0.00736131332303243, -0.00675352415258184, -0.00506691465401633, -0.00242971663116624, 0.000867920242794556, 0.00440203120341257, 0.00766731556102946, 0.0101478673294528, 0.0113964505623437, 0.0111103322505341, 0.00919119953064077, 0.00577822238111578, 0.00124677915207280, -0.00382968985574208, -0.00875150691469671, -0.0127894463078470, -0.0152928959345073, -0.0157933756007119, -0.0140869905935770, -0.0102817048118563, -0.00480001198900324, 0.00166595956073591, 0.00824259971935006, 0.0139949535886911, 0.0180620435282273, 0.0197874371423750, 0.0188249723290754, 0.0152025384562556, 0.00933258862069921, 0.00196581290867215, -0.00590701624719734, -0.0131919301907557, -0.0188479793505628, -0.0220398869611243, -0.0222641987415113, -0.0194294627261450, -0.0138775155764657, -0.00634160441110654, 0.00215346776410426, 0.0104351718247020, 0.0173502612331720, 0.0219304600697320, 0.0235323211560674, 0.0219304600697320, 0.0173502612331720, 0.0104351718247020, 0.00215346776410426, -0.00634160441110654, -0.0138775155764657, -0.0194294627261450, -0.0222641987415113, -0.0220398869611243, -0.0188479793505628, -0.0131919301907557, -0.00590701624719734, 0.00196581290867215, 0.00933258862069921, 0.0152025384562556, 0.0188249723290754, 0.0197874371423750, 0.0180620435282273, 0.0139949535886911, 0.00824259971935006, 0.00166595956073591, -0.00480001198900324, -0.0102817048118563, -0.0140869905935770, -0.0157933756007119, -0.0152928959345073, -0.0127894463078470, -0.00875150691469671, -0.00382968985574208, 0.00124677915207280, 0.00577822238111578, 0.00919119953064077, 0.0111103322505341, 0.0113964505623437, 0.0101478673294528, 0.00766731556102946, 0.00440203120341257, 0.000867920242794556, -0.00242971663116624, -0.00506691465401633, -0.00675352415258184, -0.00736131332303243, -0.00692579126630320, -0.00562399723501012, -0.00373393519175673, -0.00158357268836834, 0.000501876446252219, 0.00224629919034312, 0.00345640445847324, 0.00403918325420695, 0.00400238630718909, 0.00344000711841334, 0.00250684960173142, 0.00138746198484246, 0.000264936464691418, -0.000705615253438141, -0.00141547710442119, -0.00181095513780384, -0.00189232994728499, -0.00170477966840913, -0.00132396245541680, -0.000839395554312734, -0.000338627172940407, 0.000105423927229312, 0.000442509436653692, 0.000648039691338143, 0.000721504882577139, 0.000681488108663034, 0.000558776442653258, 0.000389091642483222, 0.000206703148531369, 3.97530713518094e-05, -9.23670535970729e-05, -0.000179687654761451, -0.000220793193805340, -0.000220977960242162, -0.000189984479364148, -0.000139765758160562, -8.25409658428109e-05]
        filter_band_6 = [-0.000124474476447680, -0.000166430371954174, -0.000178974155619620, -0.000149042763266301, -7.07388253912474e-05, 5.14277545020950e-05, 0.000200664424675636, 0.000348301193138761, 0.000457221618568168, 0.000488545218222327, 0.000410942063553405, 0.000210957628724503, -9.81460042396853e-05, -0.000471929347894839, -0.000837243431727199, -0.00110295949835311, -0.00117834194097923, -0.000996150617200605, -0.000535510707673397, 0.000161560267975292, 0.000985797123590716, 0.00177239091013768, 0.00232923332486819, 0.00247795313779849, 0.00209992991682414, 0.00117668577243324, -0.000186482150451331, -0.00176253098238370, -0.00323437952045760, -0.00425360527967623, -0.00451634901092970, -0.00384089885275125, -0.00222866726819880, 0.000108391383032695, 0.00276522017992940, 0.00520810023208913, 0.00687737451376724, 0.00730959079597825, 0.00625330333071820, 0.00375115765833474, 0.000165526670111853, -0.00386455277493526, -0.00753293498897343, -0.0100247605696052, -0.0106931237243915, -0.00921630316037805, -0.00569866891630660, -0.000687680011240790, 0.00490423631975691, 0.00996384454046420, 0.0133983321434721, 0.0143697054220240, 0.0124922031425717, 0.00794707307463684, 0.00148400910633410, -0.00569869731276041, -0.0121772666044315, -0.0165871803017459, -0.0179121084507418, -0.0157154120538397, -0.0102617157875742, -0.00249705487140185, 0.00611502057380312, 0.0138732195774573, 0.0191799675457783, 0.0208749490662926, 0.0184901357751648, 0.0123698434559303, 0.00362610975855164, -0.00606635011816188, -0.0147972903893698, -0.0208050508273709, -0.0228389012679376, -0.0204237067876438, -0.0139700202389020, -0.00470413870125710, 0.00557000838130574, 0.0148299267850633, 0.0212415747581022, 0.0235306770377631, 0.0212415747581022, 0.0148299267850633, 0.00557000838130574, -0.00470413870125710, -0.0139700202389020, -0.0204237067876438, -0.0228389012679376, -0.0208050508273709, -0.0147972903893698, -0.00606635011816188, 0.00362610975855164, 0.0123698434559303, 0.0184901357751648, 0.0208749490662926, 0.0191799675457783, 0.0138732195774573, 0.00611502057380312, -0.00249705487140185, -0.0102617157875742, -0.0157154120538397, -0.0179121084507418, -0.0165871803017459, -0.0121772666044315, -0.00569869731276041, 0.00148400910633410, 0.00794707307463684, 0.0124922031425717, 0.0143697054220240, 0.0133983321434721, 0.00996384454046420, 0.00490423631975691, -0.000687680011240790, -0.00569866891630660, -0.00921630316037805, -0.0106931237243915, -0.0100247605696052, -0.00753293498897343, -0.00386455277493526, 0.000165526670111853, 0.00375115765833474, 0.00625330333071820, 0.00730959079597825, 0.00687737451376724, 0.00520810023208913, 0.00276522017992940, 0.000108391383032695, -0.00222866726819880, -0.00384089885275125, -0.00451634901092970, -0.00425360527967623, -0.00323437952045760, -0.00176253098238370, -0.000186482150451331, 0.00117668577243324, 0.00209992991682414, 0.00247795313779849, 0.00232923332486819, 0.00177239091013768, 0.000985797123590716, 0.000161560267975292, -0.000535510707673397, -0.000996150617200605, -0.00117834194097923, -0.00110295949835311, -0.000837243431727199, -0.000471929347894839, -9.81460042396853e-05, 0.000210957628724503, 0.000410942063553405, 0.000488545218222327, 0.000457221618568168, 0.000348301193138761, 0.000200664424675636, 5.14277545020950e-05, -7.07388253912474e-05, -0.000149042763266301, -0.000178974155619620, -0.000166430371954174, -0.000124474476447680]
        filter_band_7 = [-0.000141770477587749, -0.000148882394942387, -0.000106442601714509, -1.26935034614006e-05, 0.000117206561888634, 0.000251471359520787, 0.000347129040769892, 0.000360602970992915, 0.000261784626704936, 4.81437903813073e-05, -0.000245887283971033, -0.000549054395936652, -0.000765975056140324, -0.000801881388971367, -0.000594408372083050, -0.000143396946695176, 0.000472191433785915, 0.00109956400085174, 0.00154353042149476, 0.00161988276294632, 0.00121790932632461, 0.000353122156566525, -0.000809605476415364, -0.00197654197685413, -0.00279155576390546, -0.00293600292777483, -0.00223605595622782, -0.000744212343652850, 0.00123583365398243, 0.00319878116402658, 0.00455863519162206, 0.00481449301270966, 0.00371635261526015, 0.00137928783392910, -0.00169701474288976, -0.00472288705192619, -0.00681419856725113, -0.00724251871949201, -0.00567092943332195, -0.00230233531911540, 0.00211496430962177, 0.00644273387009780, 0.00944093528368766, 0.0101171529319686, 0.00804007494386833, 0.00352072516632554, -0.00240485559699594, -0.00820508611947958, -0.0122465674464071, -0.0132515331107565, -0.0106913235625034, -0.00499658605800042, 0.00249084873425328, 0.00982982864219756, 0.0149846680886039, 0.0163912716611793, 0.0134265836629676, 0.00664122917047246, -0.00232516191207188, -0.0111400670759408, -0.0173902694705318, -0.0192480834001858, -0.0160060918578712, -0.00832353403039843, 0.00189766468742829, 0.0119877562118853, 0.0192154754749806, 0.0215365868965898, 0.0181770191232290, 0.00988277229955338, -0.00124265384437511, -0.0122791072820976, -0.0202679731092238, -0.0230172453348936, -0.0197112303771132, -0.0111530515290893, 0.000432415982451068, 0.0119863848063738, 0.0204369884052293, 0.0235293390830873, 0.0204369884052293, 0.0119863848063738, 0.000432415982451068, -0.0111530515290893, -0.0197112303771132, -0.0230172453348936, -0.0202679731092238, -0.0122791072820976, -0.00124265384437511, 0.00988277229955338, 0.0181770191232290, 0.0215365868965898, 0.0192154754749806, 0.0119877562118853, 0.00189766468742829, -0.00832353403039843, -0.0160060918578712, -0.0192480834001858, -0.0173902694705318, -0.0111400670759408, -0.00232516191207188, 0.00664122917047246, 0.0134265836629676, 0.0163912716611793, 0.0149846680886039, 0.00982982864219756, 0.00249084873425328, -0.00499658605800042, -0.0106913235625034, -0.0132515331107565, -0.0122465674464071, -0.00820508611947958, -0.00240485559699594, 0.00352072516632554, 0.00804007494386833, 0.0101171529319686, 0.00944093528368766, 0.00644273387009780, 0.00211496430962177, -0.00230233531911540, -0.00567092943332195, -0.00724251871949201, -0.00681419856725113, -0.00472288705192619, -0.00169701474288976, 0.00137928783392910, 0.00371635261526015, 0.00481449301270966, 0.00455863519162206, 0.00319878116402658, 0.00123583365398243, -0.000744212343652850, -0.00223605595622782, -0.00293600292777483, -0.00279155576390546, -0.00197654197685413, -0.000809605476415364, 0.000353122156566525, 0.00121790932632461, 0.00161988276294632, 0.00154353042149476, 0.00109956400085174, 0.000472191433785915, -0.000143396946695176, -0.000594408372083050, -0.000801881388971367, -0.000765975056140324, -0.000549054395936652, -0.000245887283971033, 4.81437903813073e-05, 0.000261784626704936, 0.000360602970992915, 0.000347129040769892, 0.000251471359520787, 0.000117206561888634, -1.26935034614006e-05, -0.000106442601714509, -0.000148882394942387, -0.000141770477587749]
        filter_band_8 = [-0.000131322864090573, -9.20484477639667e-05, 2.53987176117459e-06, 0.000129362962056063, 0.000244258573091784, 0.000294491766100860, 0.000238176808357216, 6.50209818924689e-05, -0.000189617664796327, -0.000445382422134092, -0.000596801052950172, -0.000550068053188173, -0.000266145323304105, 0.000206623203161043, 0.000727745607654990, 0.00109784148159482, 0.00112618317279741, 0.000712625010374597, -8.75629846170505e-05, -0.00104802503527458, -0.00182346537849892, -0.00206349622160021, -0.00155431277492680, -0.000335070572717083, 0.00126473780186853, 0.00269847796601591, 0.00337790182435039, 0.00289885979680380, 0.00123481999673090, -0.00118565649466088, -0.00356855642245605, -0.00500315407758021, -0.00479656397596925, -0.00277511884184999, 0.000571055550161086, 0.00417970312967896, 0.00674174891536940, 0.00716558790383315, 0.00501894119687815, 0.000775145757985712, -0.00425463810620914, -0.00831454141217942, -0.00980977197375426, -0.00791843939349877, -0.00297843991139096, 0.00351971150907404, 0.00937046214642208, 0.0123982207581128, 0.0112594673375258, 0.00600791246813818, -0.00180769635953964, -0.00958774757630088, -0.0145463185727163, -0.0147088620016593, -0.00968536810141525, -0.000919371923544815, 0.00871338924047480, 0.0158513505739599, 0.0178263571791068, 0.0136598529736378, 0.00450386574974249, -0.00666232456342051, -0.0160071055151228, -0.0201724201412270, -0.0174879999424419, -0.00863205138902866, 0.00352088248940939, 0.0148402252652243, 0.0213579978406805, 0.0206735501895400, 0.0128422804437680, 0.000417512883259509, -0.0123901362507810, -0.0211565077500430, -0.0227900151478283, -0.0166336600767266, -0.00472603371148702, 0.00888166118006524, 0.0195211062091161, 0.0235283254258358, 0.0195211062091161, 0.00888166118006524, -0.00472603371148702, -0.0166336600767266, -0.0227900151478283, -0.0211565077500430, -0.0123901362507810, 0.000417512883259509, 0.0128422804437680, 0.0206735501895400, 0.0213579978406805, 0.0148402252652243, 0.00352088248940939, -0.00863205138902866, -0.0174879999424419, -0.0201724201412270, -0.0160071055151228, -0.00666232456342051, 0.00450386574974249, 0.0136598529736378, 0.0178263571791068, 0.0158513505739599, 0.00871338924047480, -0.000919371923544815, -0.00968536810141525, -0.0147088620016593, -0.0145463185727163, -0.00958774757630088, -0.00180769635953964, 0.00600791246813818, 0.0112594673375258, 0.0123982207581128, 0.00937046214642208, 0.00351971150907404, -0.00297843991139096, -0.00791843939349877, -0.00980977197375426, -0.00831454141217942, -0.00425463810620914, 0.000775145757985712, 0.00501894119687815, 0.00716558790383315, 0.00674174891536940, 0.00417970312967896, 0.000571055550161086, -0.00277511884184999, -0.00479656397596925, -0.00500315407758021, -0.00356855642245605, -0.00118565649466088, 0.00123481999673090, 0.00289885979680380, 0.00337790182435039, 0.00269847796601591, 0.00126473780186853, -0.000335070572717083, -0.00155431277492680, -0.00206349622160021, -0.00182346537849892, -0.00104802503527458, -8.75629846170505e-05, 0.000712625010374597, 0.00112618317279741, 0.00109784148159482, 0.000727745607654990, 0.000206623203161043, -0.000266145323304105, -0.000550068053188173, -0.000596801052950172, -0.000445382422134092, -0.000189617664796327, 6.50209818924689e-05, 0.000238176808357216, 0.000294491766100860, 0.000244258573091784, 0.000129362962056063, 2.53987176117459e-06, -9.20484477639667e-05, -0.000131322864090573]
        

        array_length = raw_array.shape[1]
        seizure_event = { 'inter_ictal' : 0, 'seizure_onset' : 1, 'ictal' : 2 }
        event_array = np.zeros((1,array_length))

        sampling_rate = 256
        soz_start_sample = sampling_rate * (f['time_stamp']['start'][0] - 30)
        start_sample = sampling_rate * (f['time_stamp']['start'][0])
        end_sample = sampling_rate * (f['time_stamp']['end'][0])

        def box_text(text):
            lines = text.splitlines()
            width = max(len(s) for s in lines)
            res = [' '*7 + '#' + '─' * width + '#']
            for s in lines:
                res.append(' '*7 + '│' + (s + ' ' * width)[:width] + '│')
            res.append(' '*7 + '#' + '─' * width + '#')
            return '\n'.join(res)

        number_of_seizure = f['number_of_seizure']
        if (number_of_seizure == 0 ):
            print(box_text('NO SEIZURE DETECT'))
            np.append(raw_array, event_array, axis=0)

        elif (number_of_seizure == 1):
            print(box_text(f'{str(number_of_seizure).upper()} SEIZURE DETECT'))
            event_array[0][soz_start_sample:start_sample] = seizure_event['seizure_onset']
            event_array[0][start_sample:end_sample] = seizure_event['ictal']
            np.append(raw_array, event_array, axis=0)

        elif (number_of_seizure >= 2):
            print(box_text(f'{str(number_of_seizure).upper()} SEIZURE DETECT'))
            for i in range (number_of_seizure):
                event_array[0][sampling_rate * (f['time_stamp']['start'][i] - 30):
                            sampling_rate * (f['time_stamp']['start'][i])] = seizure_event['seizure_onset']
                event_array[0][sampling_rate * (f['time_stamp']['start'][i]):
                                sampling_rate * (f['time_stamp']['end'][i])] = seizure_event['ictal']
                np.append(raw_array, event_array, axis=0)

        else:
            print(box_text('ERROR: WRONG NUMBER_SEIZURE'))

        channels_number = f['channels']["number"]
        new_channels_number = channels_number + 1
        raw_array_with_seizure_event = np.zeros((new_channels_number, array_length))

        raw_array_with_seizure_event[:channels_number][:] = raw_array
        raw_array_with_seizure_event[channels_number][:] = event_array

        Fp2_T8 = (f['channels']['Fp2_F8']) - 1
        F8_T8 = (f['channels']['F8_T8']) - 1
        Fp2_T8_channel = raw_array_with_seizure_event[Fp2_T8] 
        F8_T8_channel = raw_array_with_seizure_event[F8_T8]
        seizure_event_channel = raw_array_with_seizure_event[channels_number]

        data_array = np.zeros((17, array_length))
        data_array[0][:] = signal.filtfilt(filter_band_1, 1, Fp2_T8_channel)
        data_array[1][:] = signal.filtfilt(filter_band_2, 1, Fp2_T8_channel)
        data_array[2][:] = signal.filtfilt(filter_band_3, 1, Fp2_T8_channel)
        data_array[3][:] = signal.filtfilt(filter_band_4, 1, Fp2_T8_channel)
        data_array[4][:] = signal.filtfilt(filter_band_5, 1, Fp2_T8_channel)
        data_array[5][:] = signal.filtfilt(filter_band_6, 1, Fp2_T8_channel)
        data_array[6][:] = signal.filtfilt(filter_band_7, 1, Fp2_T8_channel)
        data_array[7][:] = signal.filtfilt(filter_band_8, 1, Fp2_T8_channel)

        data_array[8][:] = signal.filtfilt(filter_band_1, 1, F8_T8_channel)
        data_array[9][:] = signal.filtfilt(filter_band_2, 1, F8_T8_channel)
        data_array[10][:] = signal.filtfilt(filter_band_3, 1, F8_T8_channel)
        data_array[11][:] = signal.filtfilt(filter_band_4, 1, F8_T8_channel)
        data_array[12][:] = signal.filtfilt(filter_band_5, 1, F8_T8_channel)
        data_array[13][:] = signal.filtfilt(filter_band_6, 1, F8_T8_channel)
        data_array[14][:] = signal.filtfilt(filter_band_7, 1, F8_T8_channel)
        data_array[15][:] = signal.filtfilt(filter_band_8, 1, F8_T8_channel)

        data_array[16][:] = seizure_event_channel 
        
        band, chn = 8, 2 
        energy_array = np.zeros((17, int(array_length/(sampling_rate*2))))
        for feat in range(band * chn + 1): 
            start, end = 0, 512
            count = 0
            if (feat != band * chn):
                while (end <= array_length):
                    new_sub_array = np.zeros((1, 512))
                    new_sub_array = data_array[feat][:][start: end]
                    energy_one_band = np.sum(np.power(new_sub_array, 2))
                    energy_array[feat][count] = energy_one_band
                    start, end = end, end + 512
                    count += 1
            else : 
                while (end <= array_length):
                    energy_array[feat][count] = mode(data_array[feat][:][start: end], axis=None)[0][0] 
                    start, end = end, end + 512
                    count += 1
        
        for i in range(16):
            energy_array[i] = (energy_array[i]-np.min(energy_array[i]))/(np.max(energy_array[i])-np.min(energy_array[i]))

        for i in range(16):
            data_array[i] = (data_array[i]-np.min(data_array[i]))/(np.max(data_array[i])-np.min(data_array[i]))


        data = data_array
        save_path = './energy_bands/' + patient_chb + '/chb04_new_mat'
        filename = 'data_' + f['raw_name'].split('.')[0] + '_8bands'
        np.save(os.path.join( save_path, filename ), data)

    else:
        print(f'-------------  {json_filename} is not an edf file  -------------')
        continue

print('--------Stop--------')
